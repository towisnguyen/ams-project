<div class="container-edit-user overflow-hidden">
  <button class="close-button" (click)="onExitClick()">
    <mat-icon>close</mat-icon>
  </button>
  <h1>EDIT USER</h1>
  <form [formGroup]="editUsersForm" autocomplete="off" autocomplete="off">
    <div class="flex flex-wrap -mx-6 mb-6">
      <div class="w-full md:w-1/2 px-3">
        <!-- Input username -->
        <label for="username">Username</label>
        <small class="invalid-field">&nbsp;*&nbsp;</small>
        <small
          class="invalid-field"
          [hidden]="!editUsersForm.get('username').touched"
          *ngIf="!editUsersForm.get('username').valid"
          >Required</small
        >
        <input
          type="text"
          id="username"
          name="username"
          placeholder="Enter username"
          formControlName="username"
        />
      </div>

      <!-- Input email -->
      <div class="w-full md:w-1/2 px-3">
        <label for="email">Email</label>
        <small class="invalid-field">&nbsp;*&nbsp;</small>
        <small
          class="invalid-field"
          [hidden]="!editUsersForm.get('email').touched"
          *ngIf="!editUsersForm.get('email').valid"
          >Required</small
        >
        <input
          type="email"
          id="email"
          name="email"
          placeholder="Enter email"
          formControlName="email"
        />
      </div>
    </div>
    <div class="flex flex-wrap -mx-6 mb-6">
      <div class="w-full md:w-1/2 px-3">
        <!-- Input firstName -->
        <label for="firstName">First Name</label>
        <small class="invalid-field">&nbsp;*&nbsp;</small>
        <small
          class="invalid-field"
          [hidden]="!editUsersForm.get('firstName').touched"
          *ngIf="!editUsersForm.get('firstName').valid"
          >Required</small
        >
        <input
          type="text"
          id="firstName"
          name="firstName"
          placeholder="Enter first name"
          formControlName="firstName"
        />
      </div>
      <div class="w-full md:w-1/2 px-3">
        <!-- Input lastName -->
        <label for="lastName">Last Name</label>
        <small class="invalid-field">&nbsp;*&nbsp;</small>
        <small
          class="invalid-field"
          [hidden]="!editUsersForm.get('lastName').touched"
          *ngIf="!editUsersForm.get('lastName').valid"
          >Required</small
        >
        <input
          type="text"
          id="lastName"
          name="lastName"
          placeholder="Enter last name"
          formControlName="lastName"
        />
      </div>
    </div>
    <!-- Input fullName -->
    <div class="flex flex-wrap -mx-6 mb-6">
      <div class="w-full md:w-1/2 px-3">
        <label for="fullName">Full Name</label>
        <small class="invalid-field">&nbsp;*&nbsp;</small>
        <small
          class="invalid-field"
          [hidden]="!editUsersForm.get('fullName').touched"
          *ngIf="!editUsersForm.get('fullName').valid"
          >Required</small
        >
        <input
          type="text"
          id="fullName"
          name="fullName"
          placeholder="Enter full name"
          formControlName="fullName"
        />
      </div>
      <div class="w-full md:w-1/2 px-3">
        <!-- Input phone -->
        <label for="phone">Phone</label>
        <small class="invalid-field">&nbsp;*&nbsp;</small>
        <small
          class="invalid-field"
          [hidden]="!editUsersForm.get('phone').touched"
          *ngIf="!editUsersForm.get('phone').valid"
          >Required</small
        >
        <input
          type="number"
          id="phone"
          name="phone"
          placeholder="Enter phone"
          min="1"
          formControlName="phone"
        />
      </div>
    </div>
    <div class="flex flex-wrap -mx-6 mb-6">
      <div class="w-full md:w-1/2 px-3">
        <!-- Input birthDate -->
        <label for="birthDate">D.O.B</label>
        <input
          type="date"
          id="birthDate"
          name="birthDate"
          placeholder="Enter birthDate"
          formControlName="birthDate"
        />
      </div>
      <div class="w-full md:w-1/2 px-3">
        <!-- Input address -->
        <label for="address">Address</label>
        <input
          type="text"
          id="address"
          name="address"
          placeholder="Enter address"
          formControlName="address"
        />
      </div>
    </div>
    <div class="flex flex-wrap -mx-6 mb-6">
      <div class="w-full md:w-1/3 px-3">
        <!-- Input gender -->
        <label for="gender">Gender</label>
        <small class="invalid-field">&nbsp;*&nbsp;</small>
        <small
          class="invalid-field"
          [hidden]="!editUsersForm.get('gender').touched"
          *ngIf="!editUsersForm.get('gender').valid"
          >Required</small
        >
        <select id="gender" name="gender" formControlName="gender">
          <option value="" selected disabled hidden>Select Gender</option>
          <option value="Male">Male</option>
          <option value="Female">Female</option>
          <option value="Other">Other</option>
        </select>
        <!-- Input role -->
        <label for="role">Role</label>
        <small class="invalid-field">&nbsp;*&nbsp;</small>
        <small
          class="invalid-field"
          [hidden]="!editUsersForm.get('role').touched"
          *ngIf="!editUsersForm.get('role').valid"
          >Required</small
        >
        <select id="role" name="role" formControlName="role">
          <option value="" selected disabled hidden>Select Role</option>
          <option *ngFor="let role of allRole" value="{{ role.name }}">
            {{ role.name }}
          </option>
        </select>
         <!-- Input status -->
         <label for="status">Status</label>
         <small class="invalid-field">&nbsp;*&nbsp;</small>
         <small
           class="invalid-field"
           [hidden]="!editUsersForm.get('status').touched"
           *ngIf="!editUsersForm.get('status').valid"
           >Required</small
         >
         <select id="status" name="status" formControlName="status">
           <option value="" selected disabled hidden>Select Status</option>
           <option *ngFor="let status of allStatus" value="{{ status.status }}">
             {{ status.status }}
           </option>
         </select>
      </div>
      <div class="w-full md:w-2/3 px-3">
        <!-- Input avatar -->
        <label for="avatar">Avatar</label>
        <div class="row md:py-5">
          <div  class="w-full md:w-1/3 d-inline-flex">
            <img *ngIf="displayAvatarName" src="{{urlAvatar}}" class="avatar">
            <img *ngIf="!displayAvatarName" src="../../../../../assets/images/avatar_person.jpg" alt=""class="avatar" />
          </div>
          <div class="w-full md:w-2/3">
            <div class="px-0">
            <label class="fw-bold"> Upload new avatar </label>
            </div>
            <div>
            <input id="input-file-id" style="display: none;" multiple type="file" (change)="selectAvatar($event)"/>
            <label for="input-file-id" type="button" class="btn border-success border my-[6px] w-[135px]">  Choose file...</label>
            </div>
            <div>
              <label *ngIf="!displayAvatarName">Maximum file size allowed is 1MB</label>
              <label  *ngIf="avatarFileError===''&& displayAvatarName" >File name: {{displayAvatarName}} </label>
              <label  class="invalid-field" *ngIf="avatarFileError==='type'" >&nbsp;*&nbsp;Error: File type is invalid</label>
              <label  class="invalid-field" *ngIf="avatarFileError==='size'" >&nbsp;*&nbsp;Error: File size limit</label>
            </div>
            <div>
              <button type="button" class="btn border border-danger text-danger my-[6px] w-[135px]" (click)="avatar=undefined;displayAvatarName='';urlAvatar=null"> Remove avatar</button>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="flex flex-wrap -mx-6 mb-6 align-items-center">

    </div>

    <div class="all-btn flex -mx-6 mb-6">
      <span
        *ngIf="
          !editUsersForm.get('username').invalid &&
            !editUsersForm.get('email').invalid &&
            !editUsersForm.get('firstName').invalid &&
            !editUsersForm.get('lastName').invalid &&
            !editUsersForm.get('fullName').invalid &&
            !editUsersForm.get('phone').invalid &&
            !editUsersForm.get('gender').invalid &&
            !editUsersForm.get('role').invalid &&
            !editUsersForm.get('status').invalid &&
            !avatarFileError;
          then validData;
          else invalidData
        "
      ></span>
      <ng-template #validData>
        <button
          (click)="onEditUser(editUsersForm, idOfUser)"
          class="bg-green-500 hover:bg-green-700 text-white py-2 px-4 rounded"
        >
          Save
        </button>
      </ng-template>
      <ng-template #invalidData>
        <button
          disabled
          type="submit"
          class="bg-gray-500 hover:bg-gray-700 text-white py-2 px-4 rounded"
        >
          Save
        </button>
      </ng-template>
      <button
        (click)="onExitClick()"
        class="bg-blue-500 hover:bg-blue-700 text-white py-2 px-4 rounded"
      >
        Cancel
      </button>
    </div>
  </form>
</div>
