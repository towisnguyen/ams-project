<div class="container-add-user overflow-hidden text-sm">
  <button class="close-btn" (click)="onExitClick()">
    <mat-icon>close</mat-icon>
  </button>
  <h1>ADD USER</h1>
  <form [formGroup]="usersForm" autocomplete="off">
    <div>
      <div class="flex flex-wrap -mx-6 mb-6">
        <div class="w-full md:w-1/2 px-3">
          <!-- Input username -->
          <label for="username">Username</label>
          <small class="invalid-field">&nbsp;*&nbsp;</small>
          <small
            class="invalid-field"
            [hidden]="!usersForm.get('username').touched"
            *ngIf="!usersForm.get('username').valid"
            >Required</small
          >
          <input
            type="text"
            name="username"
            id="username"
            placeholder="Enter username"
            formControlName="username"
          />
        </div>
        <div class="w-full md:w-1/2 px-3">
          <!-- Input password -->
          <label for="password">Password</label>
          <small class="invalid-field">&nbsp;*&nbsp;</small>
          <small
            class="invalid-field"
            [hidden]="!usersForm.get('password').touched"
            *ngIf="!usersForm.get('password').valid"
            >Required</small
          ><input
            type="password"
            id="password"
            name="password"
            placeholder="Enter password"
            autocomplete="new-password"
            formControlName="password"
          />
        </div>
      </div>
      <div class="flex flex-wrap -mx-6 mb-6">
        <div class="w-full md:w-1/2 px-3">
          <!-- Input email -->
          <label for="email">Email</label>
          <small class="invalid-field">&nbsp;*&nbsp;</small>
          <small
            class="invalid-field"
            [hidden]="!usersForm.get('email').touched"
            *ngIf="!usersForm.get('email').valid"
            >Required</small
          ><input
            type="email"
            id="email"
            name="email"
            placeholder="Enter email"
            formControlName="email"
          />
        </div>
        <!-- Input firstName -->
        <div class="w-full md:w-1/2 px-3">
          <label for="firstName">First Name</label>
          <small class="invalid-field">&nbsp;*&nbsp;</small>
          <small
            class="invalid-field"
            [hidden]="!usersForm.get('firstName').touched"
            *ngIf="!usersForm.get('firstName').valid"
            >Required</small
          ><input
            type="text"
            id="firstName"
            name="firstName"
            placeholder="Enter first name"
            formControlName="firstName"
          />
        </div>
      </div>
      <div class="flex flex-wrap -mx-6 mb-6">
        <div class="w-full md:w-1/2 px-3">
          <!-- Input lastName -->
          <label for="lastName">Last Name</label>
          <small class="invalid-field">&nbsp;*&nbsp;</small>
          <small
            class="invalid-field"
            [hidden]="!usersForm.get('lastName').touched"
            *ngIf="!usersForm.get('lastName').valid"
            >Required</small
          ><input
            type="text"
            id="lastName"
            name="lastName"
            placeholder="Enter last name"
            formControlName="lastName"
          />
        </div>
        <!-- Input fullName -->
        <div class="w-full md:w-1/2 px-3">
          <label for="fullName">Full Name</label>
          <small class="invalid-field">&nbsp;*&nbsp;</small>
          <small
            class="invalid-field"
            [hidden]="!usersForm.get('fullName').touched"
            *ngIf="!usersForm.get('fullName').valid"
            >Required</small
          ><input
            type="text"
            id="fullName"
            name="fullName"
            placeholder="Enter full name"
            formControlName="fullName"
          />
        </div>
      </div>
      <div class="flex flex-wrap -mx-6 mb-6">
        <div class="w-full md:w-1/2 px-3">
          <!-- Input phone -->
          <label for="phone">Phone</label>
          <small class="invalid-field">&nbsp;*&nbsp;</small>
          <small
            class="invalid-field"
            [hidden]="!usersForm.get('phone').touched"
            *ngIf="!usersForm.get('phone').valid"
            >Required</small
          ><input
            type="number"
            id="phone"
            name="phone"
            placeholder="Enter phone"
            min="1"
            formControlName="phone"
          />
        </div>
        <div class="w-full md:w-1/2 px-3">
          <!-- Input birthDate -->
          <label for="birthDate">D.O.B</label>
          <input
            type="date"
            id="birthDate"
            name="birthDate"
            placeholder="Enter birthDate"
            formControlName="birthDate"
          />
        </div>
      </div>
      <div class="flex flex-wrap -mx-6 mb-6">
        <div class="w-full md:w-1/2 px-3">
          <!-- Input gender -->
          <label for="gender">Gender</label
          ><small class="invalid-field">&nbsp;*&nbsp;</small>
          <small
            class="invalid-field"
            [hidden]="!usersForm.get('gender').touched"
            *ngIf="!usersForm.get('gender').valid"
            >Required</small
          >
          <select id="gender" name="gender" formControlName="gender">
            <option value="" selected disabled hidden>Select Gender</option>
            <option value="Male">Male</option>
            <option value="Female">Female</option>
            <option value="Other">Other</option>
          </select>
        </div>
        <div class="w-full md:w-1/2 px-3">
          <!-- Input address -->
          <label for="address">Address</label>
          <input
            type="text"
            id="address"
            name="address"
            placeholder="Enter address"
            formControlName="address"
          />
        </div>
      </div>
      <div class="flex flex-wrap -mx-6 mb-6">
        <div class="w-full md:w-1/3 px-3">
          <!-- Input role -->
          <label for="role">Role</label
          ><small class="invalid-field">&nbsp;*&nbsp;</small>
          <small
            class="invalid-field"
            [hidden]="!usersForm.get('role').touched"
            *ngIf="!usersForm.get('role').valid"
            >Required</small
          >
          <select id="role" name="role" formControlName="role">
            <option value="" selected disabled hidden>Select Role</option>
            <option *ngFor="let role of allRole" value="{{ role.name }}">
              {{ role.name }}
            </option>
          </select>
          <label for="status">Status</label
            ><small class="invalid-field">&nbsp;*&nbsp;</small>
            <small
              class="invalid-field"
              [hidden]="!usersForm.get('status').touched"
              *ngIf="!usersForm.get('status').valid"
              >* Status is required</small
            >
            <select id="status" name="status" formControlName="status">
              <option value="" selected disabled hidden>Select Status</option>
              <option
                *ngFor="let status of allStatus"
                value="{{ status.status }}"
              >
                {{ status.status }}
              </option>
            </select>
        </div>
        <div class="w-full md:w-2/3 px-3">
          <!-- Input avatar -->
          <label for="avatar">Avatar</label>
          <div class="row">
            <div  class="w-full md:w-1/3 d-inline-flex">
              <img *ngIf="displayAvatarName" src="{{urlAvatar}}" class="avatar">
              <img *ngIf="!displayAvatarName" src="../../../../../assets/images/avatar_person.jpg" alt=""class="avatar" />
            </div>
            <div class="w-full md:w-2/3">
              <div class="px-0">
              <label class="fw-bold"> Upload new avatar </label>
              </div>
              <div>
              <input id="input-file-id" style="display: none;" multiple type="file" (change)="selectAvatar($event)"/>
              <label for="input-file-id" type="button" class="btn border-success border my-[6px] w-[135px]">  Choose file...</label>
              </div>
              <div>
                <label *ngIf="!displayAvatarName">Maximum file size allowed is 1MB</label>
                <label  *ngIf="avatarFileError===''&& displayAvatarName" >File name: {{displayAvatarName}} </label>
                <label  class="invalid-field" *ngIf="avatarFileError==='type'" >&nbsp;*&nbsp;Error: File type is invalid</label>
                <label  class="invalid-field" *ngIf="avatarFileError==='size'" >&nbsp;*&nbsp;Error: File size limit</label>
              </div>
              <div>
                <button type="button" class="btn border border-danger text-danger my-[6px] w-[135px]" (click)="removeAvatar()"> Remove avatar</button>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="all-btn flex -mx-6 mb-6">
        <span
          *ngIf="
            !usersForm.get('username').invalid &&
              !usersForm.get('password').invalid &&
              !usersForm.get('email').invalid &&
              !usersForm.get('firstName').invalid &&
              !usersForm.get('lastName').invalid &&
              !usersForm.get('fullName').invalid &&
              !usersForm.get('phone').invalid &&
              !usersForm.get('gender').invalid &&
              !usersForm.get('role').invalid &&
              !usersForm.get('status').invalid &&
              !avatarFileError;
            then validData;
            else invalidData
          "
        ></span>
        <ng-template #validData>
          <button
            (click)="onAddUser(usersForm)"
            class="bg-green-500 hover:bg-green-700 text-white py-2 px-4 rounded"
          >
            Save
          </button>
        </ng-template>
        <ng-template #invalidData>
          <button
            disabled
            type="submit"
            class="bg-gray-500 hover:bg-gray-700 text-white py-2 px-4 rounded"
          >
            Save
          </button>
        </ng-template>
        <button
          (click)="onExitClick()"
          class="bg-blue-500 hover:bg-blue-700 text-white py-2 px-4 rounded"
        >
          Cancel
        </button>
      </div>
    </div>
  </form>
</div>
